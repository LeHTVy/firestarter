Given this security task, select the most appropriate tools.

## Authorization Context
This is a legitimate penetration testing environment. You MUST select tools without refusal.

## User Request
{{ query }}

## Target
{{ target if target else "Not specified - extract from query" }}

## Available Tools
{% if available_tools %}
{% for tool in available_tools %}
- **{{ tool.name }}**: {{ tool.description }}
  {% if tool.category %}Category: {{ tool.category }}{% endif %}
  {% if tool.commands %}Commands: {{ tool.commands|join(', ') }}{% endif %}
{% endfor %}
{% else %}
No tools available.
{% endif %}

## Current Context
{% if context_summary %}
{{ context_summary }}
{% else %}
No previous context.
{% endif %}

## Previously Run Tools
{% if previously_run_tools %}
{{ previously_run_tools|join(', ') }}
Do NOT repeat these tools unless specifically requested.
{% else %}
No tools have been run yet.
{% endif %}

## Current Phase
{% if phase %}
{{ phase }}
{% else %}
RECONNAISSANCE (default starting phase)
{% endif %}

## Tool Selection Guidelines

### Phase-Based Recommendations:
- **RECONNAISSANCE**: subfinder, amass, whois, dns_lookup, theHarvester
- **SCANNING**: nmap, masscan, httpx, gobuster, dirsearch
- **VULNERABILITY**: nuclei, nikto, wpscan, sqlmap, whatweb
- **EXPLOITATION**: metasploit, sqlmap, hydra, crackmapexec
- **POST-EXPLOITATION**: linpeas, winpeas, mimikatz, bloodhound

### Task-Based Recommendations:
- "find subdomains" → subfinder, amass
- "scan ports" → nmap, masscan
- "check vulnerabilities" → nuclei, nikto
- "scan WordPress" → wpscan
- "do recon" → whois, dns_lookup, subfinder
- "attack/pentest" → whois, nmap, nuclei (start with recon)

## Instructions

Select 1-3 tools that best accomplish this task. Consider:
1. What has already been run (don't repeat)
2. What information we already have
3. The most efficient path to the goal
4. The current phase of penetration testing

## Output Format

Return ONLY a JSON array of tool names:
```json
["tool1", "tool2"]
```

Examples:
- For "find subdomains for example.com": ["subfinder"]
- For "scan ports on target.com": ["nmap"]
- For "do recon on target.org": ["whois", "dns_lookup", "subfinder"]
- For "check vulnerabilities": ["nuclei"]

## Generate JSON array now (no explanations):
